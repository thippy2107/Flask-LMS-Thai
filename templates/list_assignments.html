{% extends "base.html" %}

{% block title %}‡∏á‡∏≤‡∏ô‡∏°‡∏≠‡∏ö‡∏´‡∏°‡∏≤‡∏¢‡πÉ‡∏ô {{ class_info.name }}{% endblock %}

{% block content %}
<div class="container mx-auto p-4 md:p-8">
    <div class="max-w-4xl mx-auto">
        <h1 class="text-3xl font-extrabold text-gray-800 mb-2">
            ‡∏á‡∏≤‡∏ô‡∏°‡∏≠‡∏ö‡∏´‡∏°‡∏≤‡∏¢‡πÉ‡∏ô‡∏ä‡∏±‡πâ‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ô: <span class="text-indigo-600">{{ class_info.name }}</span>
        </h1>
        <p class="text-gray-500 mb-6">
            ‡∏£‡∏´‡∏±‡∏™‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡πà‡∏ß‡∏°‡∏ä‡∏±‡πâ‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ô: <strong class="text-indigo-500">{{ class_info.join_code }}</strong>
        </p>

        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                <div class="mb-6 space-y-3">
                    {% for category, message in messages %}
                        <div class="p-4 rounded-md shadow-md flash-{{ category|default('warning') }}" role="alert">
                            {{ message }}
                        </div>
                    {% endfor %}
                </div>
            {% endif %}
        {% endwith %}

        <div class="space-y-6">
            {% if assignments %}
                {% for assignment in assignments %}
                    <div class="bg-white p-6 rounded-xl shadow-lg border border-gray-200 hover:border-indigo-300 transition duration-150">
                        <h2 class="text-xl font-bold text-gray-900 mb-2">{{ assignment.title }}</h2>
                        <p class="text-gray-600 mb-3">{{ assignment.description | default('‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏á‡∏≤‡∏ô‡∏ô‡∏µ‡πâ', true) }}</p>

                        <!-- Assignment Link (‡πÅ‡∏™‡∏î‡∏á‡∏•‡∏¥‡∏á‡∏Å‡πå‡πÉ‡∏ö‡∏á‡∏≤‡∏ô/‡πÑ‡∏ü‡∏•‡πå‡∏á‡∏≤‡∏ô ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ) -->
                        {% if assignment.file_link %}
                            <div class="mb-3">
                                <span class="text-sm font-semibold text-indigo-700 mr-2">üîó ‡πÉ‡∏ö‡∏á‡∏≤‡∏ô:</span>
                                <a href="{{ assignment.file_link }}" target="_blank" rel="noopener noreferrer"
                                   class="text-sm text-blue-600 hover:text-blue-800 underline transition duration-150 break-words">
                                    ‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡πÑ‡∏ü‡∏•‡πå‡∏á‡∏≤‡∏ô
                                </a>
                            </div>
                        {% endif %}

                        <!-- Due Date and Max Score -->
                        <div class="flex flex-col sm:flex-row sm:items-center text-sm font-medium text-gray-500 space-y-1 sm:space-y-0 sm:space-x-4 mb-4">
                            {% if assignment.due_date %}
                                <span class="text-red-600">
                                    ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏™‡πà‡∏á: {{ assignment.due_date.strftime('%d/%m/%Y ‡πÄ‡∏ß‡∏•‡∏≤ %H:%M') }}
                                </span>
                                {% set due_date_ts = assignment.due_date.timestamp() %}
                                {% set current_ts = datetime.utcnow().timestamp() %}
                                {% if current_ts > due_date_ts %}
                                    <span class="text-xs font-bold bg-red-100 text-red-700 px-2 py-0.5 rounded-full">‡πÄ‡∏•‡∏¢‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÅ‡∏•‡πâ‡∏ß</span>
                                {% else %}
                                    <span class="text-xs font-bold bg-green-100 text-green-700 px-2 py-0.5 rounded-full">‡πÄ‡∏õ‡∏¥‡∏î‡∏£‡∏±‡∏ö</span>
                                {% endif %}
                            {% else %}
                                <span class="text-gray-500">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏™‡πà‡∏á</span>
                            {% endif %}
                            <span class="text-gray-500 sm:ml-4">
                                ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÄ‡∏ï‡πá‡∏°: <strong class="text-gray-700">{{ assignment.max_score }}</strong>
                            </span>
                        </div>
                        
                        <!-- Submission Button -->
                        <a href="{{ url_for('submission_form', assignment_id=assignment.id) }}"
                           class="inline-flex items-center justify-center px-4 py-2 border border-transparent rounded-lg shadow-md text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition duration-150 w-full sm:w-auto">
                            ‡∏™‡πà‡∏á‡∏á‡∏≤‡∏ô‡∏°‡∏≠‡∏ö‡∏´‡∏°‡∏≤‡∏¢‡∏ô‡∏µ‡πâ &rarr;
                        </a>
                    </div>
                {% endfor %}
            {% else %}
                <div class="text-center p-10 bg-yellow-50 rounded-xl border border-yellow-200">
                    <p class="text-xl text-yellow-700 font-medium">
                        üéâ ‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏î‡πâ‡∏ß‡∏¢‡∏ó‡∏µ‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡πà‡∏ß‡∏°‡∏ä‡∏±‡πâ‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ô‡∏µ‡πâ!
                    </p>
                    <p class="text-sm text-yellow-600 mt-2">
                        ‡πÅ‡∏ï‡πà‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏á‡∏≤‡∏ô‡∏°‡∏≠‡∏ö‡∏´‡∏°‡∏≤‡∏¢‡πÉ‡∏î ‡πÜ ‡πÉ‡∏ô‡∏ä‡∏±‡πâ‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ô‡∏µ‡πâ
                    </p>
                </div>
            {% endif %}
        </div>
        
        <div class="mt-8 text-center">
             <a href="{{ url_for('student_landing') }}" class="text-indigo-500 hover:text-indigo-700 transition duration-150 text-sm font-medium">
                &larr; ‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡πà‡∏ß‡∏°
            </a>
        </div>
    </div>
</div>
{% endblock %}
